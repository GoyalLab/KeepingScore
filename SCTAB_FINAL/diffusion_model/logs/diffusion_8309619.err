INFO:__main__:Using device: cuda, GPUs available: 1
INFO:__main__:Loading AnnData embeddings...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
Missing logger folder: tb_logs/Vanilla Diffusion Model
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Finding best initial lr:   0%|          | 0/100 [00:00<?, ?it/s]Finding best initial lr:   1%|          | 1/100 [00:00<01:22,  1.19it/s]Finding best initial lr:   8%|▊         | 8/100 [00:00<00:08, 11.15it/s]Finding best initial lr:  15%|█▌        | 15/100 [00:01<00:04, 21.17it/s]Finding best initial lr:  22%|██▏       | 22/100 [00:01<00:02, 30.72it/s]Finding best initial lr:  28%|██▊       | 28/100 [00:01<00:03, 22.19it/s]Finding best initial lr:  35%|███▌      | 35/100 [00:01<00:02, 29.63it/s]Finding best initial lr:  42%|████▏     | 42/100 [00:01<00:01, 36.82it/s]Finding best initial lr:  49%|████▉     | 49/100 [00:01<00:01, 43.48it/s]Finding best initial lr:  56%|█████▌    | 56/100 [00:01<00:00, 49.31it/s]Finding best initial lr:  63%|██████▎   | 63/100 [00:02<00:00, 54.12it/s]Finding best initial lr:  70%|███████   | 70/100 [00:02<00:00, 32.88it/s]Finding best initial lr:  77%|███████▋  | 77/100 [00:02<00:00, 39.15it/s]Finding best initial lr:  84%|████████▍ | 84/100 [00:02<00:00, 45.01it/s]Finding best initial lr:  91%|█████████ | 91/100 [00:02<00:00, 50.37it/s]Finding best initial lr:  98%|█████████▊| 98/100 [00:02<00:00, 54.73it/s]`Trainer.fit` stopped: `max_steps=100` reached.
Finding best initial lr: 100%|██████████| 100/100 [00:02<00:00, 34.50it/s]
Learning rate set to 0.002089296130854039
Restoring states from the checkpoint path at /gpfs/projects/b1042/GoyalLab/jaekj/SCTAB_FINAL/diffusion_model/.lr_find_ec4a8f99-7a5e-4038-81fd-fdc73092b621.ckpt
/projects/b1042/GoyalLab/jaekj/python/scTAB/lib/python3.8/site-packages/lightning/fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Restored all states from the checkpoint at /gpfs/projects/b1042/GoyalLab/jaekj/SCTAB_FINAL/diffusion_model/.lr_find_ec4a8f99-7a5e-4038-81fd-fdc73092b621.ckpt
INFO:__main__:Starting training...
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name  | Type                | Params | Mode 
------------------------------------------------------
0 | model | ConditionalDenoiser | 737 K  | train
------------------------------------------------------
737 K     Trainable params
0         Non-trainable params
737 K     Total params
2.949     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
/projects/b1042/GoyalLab/jaekj/python/scTAB/lib/python3.8/site-packages/umap/umap_.py:1945: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(f"n_jobs value {self.n_jobs} overridden to 1 by setting random_state. Use no seed for parallelism.")
/projects/b1042/GoyalLab/jaekj/python/scTAB/lib/python3.8/site-packages/umap/umap_.py:1945: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(f"n_jobs value {self.n_jobs} overridden to 1 by setting random_state. Use no seed for parallelism.")
Metric val_loss improved. New best score: 0.268
Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.254
Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.243
Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.237
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.237
Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.235
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.233
Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.230
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.230
Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.228
Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.226
Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.225
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.224
Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.222
Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.219
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.219
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.218
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.217
Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.216
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.215
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.215
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.214
/projects/b1042/GoyalLab/jaekj/python/scTAB/lib/python3.8/site-packages/umap/umap_.py:1945: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(f"n_jobs value {self.n_jobs} overridden to 1 by setting random_state. Use no seed for parallelism.")
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.214
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.213
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.212
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.212
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.212
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.212
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.212
/projects/b1042/GoyalLab/jaekj/python/scTAB/lib/python3.8/site-packages/umap/umap_.py:1945: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(f"n_jobs value {self.n_jobs} overridden to 1 by setting random_state. Use no seed for parallelism.")
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.211
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.210
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.210
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.210
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.210
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209
/projects/b1042/GoyalLab/jaekj/python/scTAB/lib/python3.8/site-packages/umap/umap_.py:1945: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(f"n_jobs value {self.n_jobs} overridden to 1 by setting random_state. Use no seed for parallelism.")
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208
/projects/b1042/GoyalLab/jaekj/python/scTAB/lib/python3.8/site-packages/umap/umap_.py:1945: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(f"n_jobs value {self.n_jobs} overridden to 1 by setting random_state. Use no seed for parallelism.")
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207
/projects/b1042/GoyalLab/jaekj/python/scTAB/lib/python3.8/site-packages/umap/umap_.py:1945: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(f"n_jobs value {self.n_jobs} overridden to 1 by setting random_state. Use no seed for parallelism.")
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.206
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.206
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.206
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.205
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.205
/projects/b1042/GoyalLab/jaekj/python/scTAB/lib/python3.8/site-packages/umap/umap_.py:1945: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(f"n_jobs value {self.n_jobs} overridden to 1 by setting random_state. Use no seed for parallelism.")
Monitored metric val_loss did not improve in the last 25 records. Best score: 0.205. Signaling Trainer to stop.
INFO:__main__:Training completed.
INFO:__main__:Model saved to /projects/b1042/GoyalLab/jaekj/SCTAB_FINAL/diffusion_model/state
